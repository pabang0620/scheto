# 🤖 자동 스케줄 생성 로직 가이드

## 📋 개요
ScheduleAuto 시스템의 자동 스케줄 생성 기능은 직원들의 능력, 선호도, 가용성을 종합적으로 고려하여 최적의 근무 일정을 자동으로 배정합니다.

## 🎯 자동 생성 방식 (2가지)

### 1. 기본 자동 생성 (Basic Auto Generation)
- **목적**: 간단한 스케줄 생성
- **특징**: 기본적인 점수 시스템 사용
- **적용 시나리오**: 소규모 팀, 단순한 근무 패턴

### 2. 고급 자동 생성 (Advanced Generation) ⭐
- **목적**: 정교한 스케줄 최적화
- **특징**: 가중치 기반 다차원 평가
- **적용 시나리오**: 대규모 팀, 복잡한 근무 요구사항

---

## 📊 점수 계산 시스템

### 🏆 고급 생성 가중치 구조
```
총 점수 = (능력치 × 40%) + (선호도 × 30%) + (선임도 × 20%) + (가용성 × 10%)
```

### 1. 능력치 평가 (40% 가중치)
```javascript
능력치 점수 = (
  업무스킬 + 고객서비스 + 경험 + 
  유연성 + 팀워크 + 리더십 + 
  문제해결 + 커뮤니케이션 + 전문지식
) ÷ 9

최종 능력 점수 = 능력치점수 × 0.4 × 10
```

**능력치 등급별 점수**:
- S급: 5점 (최고 숙련도)
- A급: 4점 (높은 숙련도)  
- B급: 3점 (보통 숙련도)
- C급: 2점 (기초 숙련도)
- D급: 1점 (초보 수준)

### 2. 선호도 평가 (30% 가중치) ⭐

**선호 요일 시스템**:
```javascript
if (직원이_이날을_선호함) {
  점수 += 0.3 × 10 = +3점 보너스
}

if (직원이_이날을_기피함) {
  점수 -= 0.3 × 5 = -1.5점 패널티
}
```

**요일별 선호도 설정**:
- **선호 요일** (preferDays): 근무하고 싶은 요일
- **기피 요일** (avoidDays): 피하고 싶은 요일
- **고정 휴무일** (fixedOffDays): 절대 근무 불가한 요일

### 3. 선임도 평가 (20% 가중치)
```javascript
근무연수 = (현재날짜 - 입사날짜) ÷ 365일

선임도 점수 = 근무연수 × 0.2 × 2
```

### 4. 가용성 평가 (10% 가중치)
- **휴가 승인 여부** 확인
- **이미 배정된 스케줄** 중복 방지
- **연속 근무일 제한** 준수
- **일일 근무시간 제한** 준수

---

## 🔄 자동 생성 프로세스

### Step 1: 데이터 수집
```
1. 직원 목록 조회 (능력치, 선호도, 제약사항 포함)
2. 기존 스케줄 조회 (중복 방지용)
3. 승인된 휴가 조회 (가용성 확인)
4. 근무 패턴 정의 (시간대, 필요 인원)
```

### Step 2: 후보자 선별
```
각 날짜/시간대별로:
1. 휴가 중인 직원 제외
2. 이미 스케줄 있는 직원 제외  
3. 연속 근무일 초과 직원 제외
4. 근무시간 제한 초과 직원 제외
```

### Step 3: 점수 계산
```
for 각 후보 직원:
  기본점수 = 50점
  
  능력점수 = 계산_능력치점수(직원.능력치)
  선호점수 = 계산_선호도점수(직원.선호도, 해당요일)  
  선임점수 = 계산_선임도점수(직원.입사일)
  가용점수 = 계산_가용성점수(직원.제약사항)
  
  최종점수 = 기본점수 + 능력점수 + 선호점수 + 선임점수 + 가용점수
```

### Step 4: 최적 배정
```
1. 점수 기준 내림차순 정렬
2. 필요 인원수만큼 상위 직원 선택
3. 충돌 검사 및 해결
4. 스케줄 생성 및 저장
```

---

## 🎮 직원 선호도 설정 방법

### 프론트엔드 설정 위치
**경로**: `마이페이지 > 근무 선호도 설정`

### 설정 가능한 항목
1. **선호 요일**: 근무를 선호하는 요일들
2. **기피 요일**: 가능하면 피하고 싶은 요일들
3. **선호 시간대**: 오전/오후/저녁/야간 중 선호
4. **고정 휴무일**: 절대 근무할 수 없는 요일

### 설정 예시
```
김직원의 선호도 설정:
✅ 선호 요일: 월요일, 화요일, 수요일
❌ 기피 요일: 토요일, 일요일  
⏰ 선호 시간: 오전 근무 (09:00-17:00)
🚫 고정 휴무: 일요일 (종교적 이유)
```

---

## 📈 실제 점수 계산 예시

### 시나리오: 금요일 오후 근무 배정

**직원 A (3년차, B급 능력, 금요일 선호)**
```
기본 점수: 50점
능력 점수: 3 × 0.4 × 10 = 12점
선호 점수: +3점 (금요일 선호)
선임 점수: 3년 × 0.2 × 2 = 1.2점  
가용 점수: 0점 (제약 없음)

총점: 66.2점
```

**직원 B (1년차, A급 능력, 금요일 기피)**
```
기본 점수: 50점
능력 점수: 4 × 0.4 × 10 = 16점
선호 점수: -1.5점 (금요일 기피)
선임 점수: 1년 × 0.2 × 2 = 0.4점
가용 점수: 0점 (제약 없음)

총점: 64.9점
```

**결과**: 직원 A가 더 높은 점수로 배정됨 (선호도 반영)

---

## ⚖️ 공정성 보장 시스템

### 1. 공정 분배 (Fair Distribution)
```javascript
평균_근무일 = 전체_근무일 ÷ 전체_직원수
공정성_보너스 = (평균_근무일 - 개인_근무일) × 2

// 적게 일한 직원에게 보너스 점수 부여
```

### 2. 연속 근무 제한
- **최대 연속 근무일**: 5일 (기본값)
- **최소 휴식 시간**: 12시간
- **주간 최대 시간**: 40시간

### 3. 충돌 해결 메커니즘
```
충돌 유형:
1. 중복 배정: 같은 시간대 2곳 이상 배정
2. 시간 부족: 연속 근무간 휴식시간 부족  
3. 제약 위반: 개인 제약사항 위반
4. 인원 부족: 필요 인원 미달

해결 방법:
- 점수 기반 재배정
- 대체 인력 자동 선정
- 관리자 확인 요청
```

---

## 🎯 최적화 기능

### 1. 패턴 기반 학습
- **과거 스케줄 분석**: 성공적인 배정 패턴 학습
- **계절별 조정**: 시기별 근무 패턴 최적화
- **부서별 특성**: 부서 고유 요구사항 반영

### 2. 실시간 조정
- **긴급 상황 대응**: 급작스러운 결원 발생시 자동 재배정
- **휴가 승인시**: 연관 스케줄 자동 조정
- **팀워크 고려**: 궁합이 좋은 직원 조합 우선 배정

### 3. 성과 측정
```
공정성 지수 = 1 - (개인별_근무시간_편차 ÷ 평균_근무시간)

만족도 점수 = (선호도_반영률 × 0.4) + 
              (공정성_지수 × 0.3) + 
              (제약준수율 × 0.3)
```

---

## 🔧 관리자 제어 기능

### 1. 생성 옵션 설정
```javascript
생성_옵션 = {
  respectPreferences: true,    // 선호도 존중 여부
  fairDistribution: true,      // 공정 분배 활성화
  skillBasedAssignment: true,  // 능력 기반 배정
  minimumRestHours: 12,        // 최소 휴식 시간
  maxConsecutiveDays: 5        // 최대 연속 근무일
}
```

### 2. 수동 조정 가능
- **개별 스케줄 수정**: 자동 생성 후 수동 조정
- **제약 조건 추가**: 특별 요구사항 반영  
- **패턴 저장**: 자주 사용하는 설정 저장
- **미리보기 기능**: 생성 전 결과 확인

### 3. 보고서 생성
- **커버리지 분석**: 시간대별 인력 현황
- **공정성 리포트**: 직원별 근무시간 분포
- **선호도 충족률**: 개인 선호도 반영 정도
- **효율성 지표**: 생성 시간, 충돌률 등

---

## 📱 사용자 인터페이스

### 자동 생성 V2 (권장)
1. **패턴 관리자**: 근무 패턴 설정 및 저장
2. **미리보기**: 생성 전 결과 확인  
3. **충돌 관리자**: 문제 상황 자동 해결
4. **실시간 조정**: 즉석에서 수정 가능

### 생성 과정
```
1. 기간 설정 (시작일 ~ 종료일)
2. 근무 패턴 선택/생성
3. 제약 조건 설정
4. 미리보기 확인
5. 자동 생성 실행  
6. 결과 검토 및 수정
7. 최종 승인 및 저장
```

---

## 🚀 고급 활용 팁

### 1. 효율적인 패턴 설정
- **시간대별 인원**: 바쁜 시간대에 더 많은 인력 배치
- **스킬 요구사항**: 특정 업무에 필요한 능력 명시
- **팀 조합**: 경험자와 신입 적절히 배치

### 2. 선호도 최적화
- **개인 상담**: 직원과 소통하여 실제 선호도 파악
- **주기적 업데이트**: 상황 변화에 따른 선호도 조정
- **인센티브 제공**: 비인기 시간대 근무 시 보상

### 3. 지속적인 개선
- **피드백 수집**: 직원 만족도 정기 조사
- **데이터 분석**: 생성 결과의 성과 측정
- **시스템 업데이트**: 새로운 요구사항 반영

---

## ❓ FAQ (자주 묻는 질문)

### Q: 선호도를 설정했는데 반영이 안 되는 것 같아요
**A**: 선호도는 30% 가중치로 반영됩니다. 다른 요소(능력치 40%, 선임도 20%, 가용성 10%)와 종합하여 결정되므로 항상 선호도대로만 배정되지는 않습니다.

### Q: 특정 직원이 너무 많이/적게 배정되는 것 같아요  
**A**: 공정 분배 옵션을 활성화하면 전체 직원의 근무시간이 균등하게 분배됩니다. 관리자 설정에서 확인해보세요.

### Q: 자동 생성 결과를 수정할 수 있나요?
**A**: 네, 자동 생성 후 개별 스케줄을 수동으로 수정할 수 있습니다. 드래그 앤 드롭으로 쉽게 조정 가능합니다.

### Q: 긴급상황으로 스케줄을 바꿔야 할 때는?
**A**: 충돌 관리자에서 대체 인력을 자동으로 추천해드립니다. 또는 수동으로 직접 수정하실 수 있습니다.

---

**📝 문서 버전**: v2.0  
**📅 마지막 업데이트**: 2025-08-20  
**👨‍💻 작성자**: Claude (ScheduleAuto AI Assistant)